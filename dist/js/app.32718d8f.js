(function(){"use strict";var e={6879:function(e,a,o){var t=o(4220),n=o(8587),s=o(9812);const r={class:"app-container"};function l(e,a,o,t,n,l){const i=(0,s.up)("Menu"),c=(0,s.up)("SandBox"),d=(0,s.up)("EanLoader"),u=(0,s.up)("BookstoreList"),g=(0,s.up)("Prices"),m=(0,s.up)("MessageList");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i),(0,s._)("div",r,[n.sandbox?((0,s.wg)(),(0,s.j4)(c,{key:0})):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},["Dodaj Eany"==n.menuStore.activeTab?((0,s.wg)(),(0,s.j4)(d,{key:0})):(0,s.kq)("",!0),"Ustawienia Księgarń"!=n.menuStore.activeTab||n.sandbox?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:1})),"Pobrane Ceny"!=n.menuStore.activeTab||n.sandbox?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(g,{key:2}))],64)),(0,s._)("button",{onClick:a[0]||(a[0]=e=>n.messageStore.addMessage(parseInt(1e3*Math.random())%2==0?"danger":"success","dupa")),style:{position:"fixed",left:"0",top:"300px"}}," Add random message "),(0,s.Wm)(m)])],64)}var i=o(5893);const c={class:"messages"};function d(e,a,o,n,r,l){const d=(0,s.up)("Message");return(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["main",{hidden:!r.messageStore.newMessage}])},[(0,s._)("div",{class:"delete-all",onClick:a[0]||(a[0]=e=>r.messageStore.deleteAll())},"Wyczyść"),(0,s._)("div",c,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.messageStore.messages,(a=>(0,s.wy)(((0,s.wg)(),(0,s.j4)(d,{message:a,key:a.msg+a.time},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(a.msg),1)])),_:2},1032,["message"])),[[t.F8,!e.hidden||r.messageStore.newMessage]]))),128))])],2)),[[t.F8,r.messageStore.messages.length>0]])}const u=(0,n.Q_)("messageStore",{state(){return{messages:[],newMessage:!1}},actions:{addMessage(e,a,o){this.messages.unshift({type:e,msg:a,...o,time:(new Date).toLocaleString("pl-PL").replace(/\d+\.\d+\.\d+, /,"")}),this.setNewMessageState(!0)},deleteMessage(e){this.messages.splice(this.messages.indexOf(e),1)},setNewMessageState(e){this.newMessage=e},deleteAll(){this.messages=[]}}}),g=["href"],m={class:"time"};function v(e,a,o,t,n,r){return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["box",o.message.type])},[(0,s._)("div",{class:"close",onClick:a[0]||(a[0]=e=>n.messageStore.deleteMessage(o.message))},"❌"),(0,s._)("div",null,[(0,s.WI)(e.$slots,"default",{},void 0,!0)]),o.message.url?((0,s.wg)(),(0,s.iD)("a",{key:0,target:"_blank",href:o.message.url},"KLIK",8,g)):(0,s.kq)("",!0),(0,s._)("div",m,(0,i.zw)(o.message.time),1)],2)}var p={name:"Message",props:["message"],data(){return{messageStore:u()}}},b=o(8998);const k=(0,b.Z)(p,[["render",v],["__scopeId","data-v-718d9972"]]);var h=k,w={name:"MessageList",components:{Message:h},data(){return{messageStore:u()}},methods:{}};const f=(0,b.Z)(w,[["render",d],["__scopeId","data-v-006374aa"]]);var y=f;const S={class:"main"},_={class:"run-box"};function D(e,a,o,t,n,r){const l=(0,s.up)("Bookstore");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",S,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.keys(n.configStore.bookstores),(e=>((0,s.wg)(),(0,s.j4)(l,{key:e,bookstore:e},null,8,["bookstore"])))),128))]),(0,s._)("div",_,[(0,s._)("button",{onClick:a[0]||(a[0]=e=>n.ajaxStore.startAjaxes())},"GO"),(0,s._)("button",{onClick:a[1]||(a[1]=e=>n.ajaxStore.stopAjaxes())},"STOP")])],64)}const x=(0,n.Q_)("configStore",{state(){return{bookstores:{bonito:{name:"Bonito",download:{default:{possible:!0,value:!1},google:{possible:!1,value:!1}},searchURL:""},tantis:{name:"Tantis",download:{default:{possible:!0,value:!1},google:{possible:!0,value:!1}},searchURL:""},empik:{name:"Empik",download:{default:{possible:!0,value:!1},google:{possible:!1,value:!1}},searchURL:""}}}},actions:{activateDownload(e,a){this.bookstores[e].download[a].possible&&(this.bookstores[e].download[a].value=!0)},deactivateDownload(e,a){this.bookstores[e].download[a].value=!1},canBeDownloaded(e,a){return this.bookstores[e].download[a].possible},isDownloading(e,a){return this.bookstores[e].download[a].value},isBookstoreActive(e){return this.bookstores[e].download["default"].value||this.bookstores[e].download["google"].value}}}),j=e=>((0,s.dD)("data-v-51e2defe"),e=e(),(0,s.Cn)(),e),z=j((()=>(0,s._)("div",{class:"delays-text"},"opóźnienia",-1))),M={class:"delays"},C={class:"left-in-queue"},I=j((()=>(0,s._)("span",null,"pozostało",-1)));function B(e,a,o,n,r,l){const c=(0,s.up)("BookstorePriceToggler");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["main",{active:l.active&&l.left>0}])},[(0,s._)("h3",null,(0,i.zw)(r.configStore.bookstores[o.bookstore].name),1),((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(["default","google"],(e=>(0,s.Wm)(c,{key:e,download:e,bookstore:o.bookstore},null,8,["download","bookstore"]))),64)),z,(0,s._)("div",M,[(0,s.wy)((0,s._)("input",{type:"number",min:"1",max:"20","onUpdate:modelValue":a[0]||(a[0]=e=>r.ajaxStore.threads[o.bookstore].minDelay=e)},null,512),[[t.nr,r.ajaxStore.threads[o.bookstore].minDelay]]),(0,s.wy)((0,s._)("input",{type:"number",min:"1",max:"20","onUpdate:modelValue":a[1]||(a[1]=e=>r.ajaxStore.threads[o.bookstore].maxDelay=e)},null,512),[[t.nr,r.ajaxStore.threads[o.bookstore].maxDelay]])]),(0,s._)("div",C,[I,(0,s._)("span",null,(0,i.zw)(l.left),1)])],2)}function O(e,a,o,t,n,r){const l=(0,s.up)("TogglerBtn");return(0,s.wg)(),(0,s.j4)(l,{onClick:r.toggle,active:n.configStore.isDownloading(o.bookstore,o.download),disabled:!n.configStore.canBeDownloaded(o.bookstore,o.download),title:n.configStore.canBeDownloaded(o.bookstore,o.download)?"":"Obsługa nie została zaimplementowana"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)("google"==o.download?"Google":"Zwykłe"),1)])),_:1},8,["onClick","active","disabled","title"])}function q(e,a,o,t,n,r){return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)({active:o.active,disabled:o.disabled})},[(0,s._)("span",null,(0,i.zw)(o.active?"✔️":"❌"),1),(0,s.WI)(e.$slots,"default",{},void 0,!0)],2)}var E={name:"TogglerBtn",props:{active:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1}}};const L=(0,b.Z)(E,[["render",q],["__scopeId","data-v-903cd674"]]);var T=L,A={name:"BookstorePriceToggler",components:{TogglerBtn:T},props:{bookstore:{type:String,required:!0},download:{type:String,required:!0}},data(){return{configStore:x()}},methods:{toggle(){this.configStore.isDownloading(this.bookstore,this.download)?this.configStore.deactivateDownload(this.bookstore,this.download):this.configStore.canBeDownloaded(this.bookstore,this.download)&&this.configStore.activateDownload(this.bookstore,this.download)}}};const P=(0,b.Z)(A,[["render",O]]);var F=P;const U=(0,n.Q_)("ajaxStore",{state(){return{isFinishedInterval:null,messageStore:u(),configStore:x(),threads:{tantis:{name:"tantis",interval:null,lastReq:null,minDelay:1,maxDelay:2,queue:[{callback:(e,a)=>console.log(e,a.name),data:"raz"},{callback:(e,a)=>console.log(e,a.name),data:"dwa"},{callback:(e,a)=>console.log(e,a.name),data:"trzy"},{callback:(e,a)=>console.log(e,a.name),data:"cztery"},{callback:(e,a)=>console.log(e,a.name),data:"pięć"},{callback:(e,a)=>console.log(e,a.name),data:"sześć"}]},bonito:{name:"bonito",interval:null,lastReq:null,minDelay:3,maxDelay:6,queue:[{callback:(e,a)=>console.log(e,a.name),data:"raz"},{callback:(e,a)=>console.log(e,a.name),data:"dwa"},{callback:(e,a)=>console.log(e,a.name),data:"trzy"},{callback:(e,a)=>console.log(e,a.name),data:"cztery"},{callback:(e,a)=>console.log(e,a.name),data:"pięć"},{callback:(e,a)=>console.log(e,a.name),data:"sześć"},{callback:(e,a)=>console.log(e,a.name),data:"siedem"},{callback:(e,a)=>console.log(e,a.name),data:"osiem"},{callback:(e,a)=>console.log(e,a.name),data:"dziewięc"},{callback:(e,a)=>console.log(e,a.name),data:"dziesięć"},{callback:(e,a)=>console.log(e,a.name),data:"jedenaście"},{callback:(e,a)=>console.log(e,a.name),data:"dwanaście"},{callback:(e,a)=>console.log(e,a.name),data:"trzynaście"},{callback:(e,a)=>console.log(e,a.name),data:"czternaście"}]},empik:{name:"empik",interval:null,lastReq:null,minDelay:5,maxDelay:7,queue:[{callback:(e,a)=>console.log(e,a.name),data:"raz"},{callback:(e,a)=>console.log(e,a.name),data:"dwa"},{callback:(e,a)=>console.log(e,a.name),data:"trzy"},{callback:(e,a)=>console.log(e,a.name),data:"cztery"},{callback:(e,a)=>console.log(e,a.name),data:"pięć"},{callback:(e,a)=>console.log(e,a.name),data:"sześć"},{callback:(e,a)=>console.log(e,a.name),data:"siedem"},{callback:(e,a)=>console.log(e,a.name),data:"osiem"},{callback:(e,a)=>console.log(e,a.name),data:"dziewięć"}]}}}},actions:{rand(e,a){return Math.floor(Math.random()*(a-e))+e},isLocked(e){if(!e.lastReq)return!1;const a=Date.now(),o=this.rand(1e3*e.minDelay,1e3*e.maxDelay);return a<=e.lastReq+o},lock(e){e.lastReq=Date.now()},startAjaxes(){if(this.isFinishedInterval)return;const e=Object.values(this.threads);if(e.length){for(const a of e)a.interval=setInterval((()=>{if(a.queue.length){if(!this.isLocked(a)&&this.configStore.bookstores[a.name].download.default.value){const{callback:e,data:o}=a.queue.shift();e(o,a),this.lock(a)}}else this.messageStore.addMessage("success","Zakończono pobieranie dla "+a.name),clearInterval(a.interval),a.interval=null}),1e3);this.isFinishedInterval=setInterval((()=>{Object.values(this.threads).filter((e=>e.interval)).length||(this.messageStore.addMessage("success","Pobieranie cen zakończone powodzeniem."),clearInterval(this.isFinishedInterval),this.isFinishedInterval=null)}),1e3)}},stopAjaxes(){for(const e of Object.values(this.threads))clearInterval(e.interval),e.interval=null;clearInterval(this.isFinishedInterval),this.isFinishedInterval=null}}});var Z={name:"Bookstore",props:{bookstore:{type:String,required:!0}},components:{BookstorePriceToggler:F},data(){return{configStore:x(),ajaxStore:U()}},computed:{active(){return this.configStore.isBookstoreActive(this.bookstore)},left(){return this.ajaxStore.threads[this.bookstore].queue.length}}};const K=(0,b.Z)(Z,[["render",B],["__scopeId","data-v-51e2defe"]]);var W=K,H={name:"BookstoreList",components:{Bookstore:W},data(){return{configStore:x(),ajaxStore:U()}}};const R=(0,b.Z)(H,[["render",D],["__scopeId","data-v-3ca49eb2"]]);var Y=R;const N={class:"menu"},Q=["onClick"];function G(e,a,o,t,n,r){return(0,s.wg)(),(0,s.iD)("div",N,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(["Ustawienia Księgarń","Dodaj Eany","Pobrane Ceny","Logi"],(e=>(0,s._)("div",{class:(0,i.C_)({active:n.menuStore.activeTab==e}),key:e,onClick:a=>n.menuStore.activeTab=e},(0,i.zw)(e),11,Q))),64))])}const V=(0,n.Q_)("menuStore",{state(){return{activeTab:null}},actions:{}});var $={name:"Menu",data(){return{menuStore:V()}}};const J=(0,b.Z)($,[["render",G],["__scopeId","data-v-20466e8c"]]);var X=J;const ee={class:"wrapper"};function ae(e,a,o,t,n,r){return(0,s.wg)(),(0,s.iD)("div",ee,[(0,s._)("button",{onClick:a[0]||(a[0]=e=>n.ajaxStore.startAjaxes())},"GO"),(0,s._)("button",{onClick:a[1]||(a[1]=e=>n.ajaxStore.stopAjaxes())},"STOP")])}var oe={name:"SandBox",components:{},data(){return{messageStore:u(),ajaxStore:U()}}};const te=(0,b.Z)(oe,[["render",ae],["__scopeId","data-v-187a40be"]]);var ne=te;const se={class:"ean-loader"},re={class:"options"},le={class:"ean-list-wrapper"},ie={class:"ean-list"},ce=["onClick"];function de(e,a,o,n,r,l){return(0,s.wg)(),(0,s.iD)("div",se,[(0,s._)("div",re,[(0,s.wy)((0,s._)("div",{onClick:a[0]||(a[0]=(...e)=>l.loadEans&&l.loadEans(...e))},(0,i.zw)(l.addString),513),[[t.F8,r.eans]]),(0,s.wy)((0,s._)("div",{onClick:a[1]||(a[1]=e=>l.loadEans("overwrite"))},"Nadpisz",512),[[t.F8,r.eans&&!r.eanStore.empty]]),(0,s.wy)((0,s._)("div",{onClick:a[2]||(a[2]=(...e)=>l.clearEans&&l.clearEans(...e))},"Wyczyść Listę",512),[[t.F8,!r.eanStore.empty]])]),(0,s._)("div",le,[(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":a[3]||(a[3]=e=>r.eans=e)},null,512),[[t.nr,r.eans]]),(0,s._)("div",ie,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.eanStore.eans,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.code,class:"ean-item"},[(0,s._)("span",{class:"delete",onClick:a=>r.eanStore.removeEan(e.code)},"❌",8,ce),(0,s._)("span",null,(0,i.zw)(e.code),1)])))),128))])])])}const ue=(0,n.Q_)("eanStore",{state(){return{eans:{},empty:!0}},actions:{loadEans(e,a=!1){if("overwrite"==a)for(const o in this.eans)delete this.eans[o];"string"==typeof e&&(e=e.split("\n").map((e=>e.trim())).filter((e=>e)));for(const o of e)this.eans[o]={code:o,prices:{}};this.empty=0==Object.keys(this.eans).length},removeEan(e){this.eans[e]&&delete this.eans[e],this.empty=0==Object.keys(this.eans).length}}});var ge={name:"EanLoader",data(){return{eanStore:ue(),eans:""}},methods:{loadEans(e=!1){this.eanStore.loadEans(this.eans,e),this.eans=""},clearEans(){this.eanStore.loadEans("","overwrite")}},computed:{addString(){return"Dodaj"+(Object.keys(this.eanStore.eans).length>0?" do istniejących":"")}}};const me=(0,b.Z)(ge,[["render",de],["__scopeId","data-v-1bb47dd6"]]);var ve=me;function pe(e,a,o,t,n,r){return(0,s.wg)(),(0,s.iD)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.eanStore.eans,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.code},(0,i.zw)(e.code)+": ",1)))),128))])}var be={name:"Prices",data(){return{eanStore:ue()}}};const ke=(0,b.Z)(be,[["render",pe]]);var he=ke,we={name:"App",components:{MessageList:y,BookstoreList:Y,SandBox:ne,Menu:X,EanLoader:ve,Prices:he},data(){return{messageStore:u(),menuStore:V(),sandbox:!1}},mounted(){this.menuStore.activeTab="Ustawienia Księgarń";const e=parseInt(1e3*Math.random())%2?"http://192.168.1.100:8080/price-scraper/dist/":"https://classic.bonito.pl/";fetch(e,{credentials:"include",mode:"cors"}).then((()=>{this.messageStore.addMessage("success","Konfiguracja prawidłowa, możemy zaczynać.")})).catch((e=>{"NetworkError when attempting to fetch resource."==e.message&&this.messageStore.addMessage("danger",'UWAGA! Nie będę mógł pobierać cen z bonito. Włącz dodatek "Corse everywhere" w przeglądarce i odśwież stronę.',{url:"https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/"})}))}};const fe=(0,b.Z)(we,[["render",l]]);var ye=fe;const Se=(0,n.WB)(),_e=(0,t.ri)(ye);_e.use(Se),_e.mount("#price-scraper-app")}},a={};function o(t){var n=a[t];if(void 0!==n)return n.exports;var s=a[t]={exports:{}};return e[t].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(a,t,n,s){if(!t){var r=1/0;for(d=0;d<e.length;d++){t=e[d][0],n=e[d][1],s=e[d][2];for(var l=!0,i=0;i<t.length;i++)(!1&s||r>=s)&&Object.keys(o.O).every((function(e){return o.O[e](t[i])}))?t.splice(i--,1):(l=!1,s<r&&(r=s));if(l){e.splice(d--,1);var c=n();void 0!==c&&(a=c)}}return a}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[t,n,s]}}(),function(){o.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(a,{a:a}),a}}(),function(){o.d=function(e,a){for(var t in a)o.o(a,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={143:0};o.O.j=function(a){return 0===e[a]};var a=function(a,t){var n,s,r=t[0],l=t[1],i=t[2],c=0;if(r.some((function(a){return 0!==e[a]}))){for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(i)var d=i(o)}for(a&&a(t);c<r.length;c++)s=r[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},t=self["webpackChunkprice_scraper"]=self["webpackChunkprice_scraper"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=o.O(void 0,[998],(function(){return o(6879)}));t=o.O(t)})();
//# sourceMappingURL=app.32718d8f.js.map